<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI助手 - 智能对话</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🤖</text></svg>">
</head>
<body>
    <div class="container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> AI助手</h2>
                <button class="new-chat-btn" onclick="startNewChat()">
                    <i class="fas fa-plus"></i> 新对话
                </button>
            </div>
            <div class="chat-history" id="chatHistory">
                <!-- 聊天历史将在这里动态生成 -->
            </div>
            <div class="sidebar-footer">
                <div class="sidebar-actions">
                    <button class="action-btn tooltip" onclick="exportChat()" title="导出聊天记录">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="action-btn tooltip" onclick="clearAllChats()" title="清空所有对话">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="action-btn tooltip" onclick="toggleTheme()" title="切换主题">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 主聊天区域 -->
        <div class="main-chat">
            <!-- 顶部工具栏 -->
            <div class="chat-header">
                <div class="chat-title">
                    <h3 id="currentChatTitle">AI助手</h3>
                    <span class="chat-status" id="chatStatus">在线</span>
                </div>
                <div class="chat-actions">
                    <button class="header-btn tooltip" onclick="toggleSidebar()" title="切换侧边栏">
                        <i class="fas fa-bars"></i>
                    </button>
                    <button class="header-btn tooltip" onclick="fullscreen()" title="全屏模式">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>

            <!-- 聊天消息区域 -->
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <div class="welcome-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>欢迎使用AI助手</h3>
                    <p>我可以帮助你进行股票策略分析、回答问题、分析图片、编写代码等。请开始你的对话吧！</p>
                    <div class="welcome-features">
                        <div class="feature-item">
                            <i class="fas fa-comments"></i>
                            <span>智能对话</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-chart-line"></i>
                            <span>股票分析</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-image"></i>
                            <span>图片分析</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-code"></i>
                            <span>代码生成</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 输入区域 -->
            <div class="input-area">
                <div class="input-container">
                    <div class="input-wrapper">
                        <textarea 
                            id="messageInput" 
                            placeholder="输入你的问题，支持文字和图片... (Shift+Enter换行，Enter发送)"
                            rows="1"
                            onkeydown="handleKeyDown(event)"
                        ></textarea>
                        <div class="input-actions">
                            <button class="upload-btn tooltip" onclick="document.getElementById('imageInput').click()" title="上传图片">
                                <i class="fas fa-image"></i>
                            </button>
                            <button class="voice-btn tooltip" onclick="startVoiceInput()" title="语音输入">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <button class="send-btn" onclick="sendMessage()" id="sendBtn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)" multiple>
                </div>
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <span>AI正在思考...</span>
                </div>
                <div class="input-tips">
                    <span class="tip">💡 提示：你可以询问股票分析问题，上传图片让AI分析，或者询问编程问题</span>
                </div>
            </div>
        </div>
    </div>

    <!-- 语音输入模态框 -->
    <div class="modal" id="voiceModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>语音输入</h3>
                <button class="close-btn" onclick="closeVoiceModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="voice-visualizer" id="voiceVisualizer">
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                </div>
                <p id="voiceStatus">点击麦克风开始录音...</p>
            </div>
            <div class="modal-footer">
                <button class="voice-btn-large" onclick="toggleVoiceRecording()" id="voiceToggleBtn">
                    <i class="fas fa-microphone"></i>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
